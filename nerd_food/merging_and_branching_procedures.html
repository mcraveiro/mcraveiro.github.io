<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-03-28 Sun 15:44 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Nerd Food: Merging and Branching Procedures</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" href="../css/tufte.css" type="text/css" />
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">Nerd Food: Merging and Branching Procedures</h1>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><a href="../index.html">Back to home page</a></td>
<td class="org-left"><a href="index.html">Back to essay index</a></td>
</tr>
</tbody>
</table>

<p>
<i>Historical context: this essay was written in the days of CVS and
Subversion, prior to Git being the dominant VCS.</i>
</p>

<p>
Monday, June 04, 2007
</p>

<p>
It seems version control is a popular topic again, thanks to the ever
courteous Linus. If you haven't seen the talk he gave at Google, do
watch it as it's quite interesting. Linus, in his usual
so-offensive-its-funny style, criticises SVN to death. I got to say
that I quite like SVN, perhaps because I've been forced to use
ClearCase, SourceSafe, RCS and CVS for far too long. My only complaint
with SVN has always been the terrible merging, something that Linus
rightly criticises on his talk. The good news is it appears the most
severe problems with merging will be fixed on the next SVN release.
</p>

<p>
Linus' talk did make me more aware of distributed version control
though, but I'm not entirely convinced it would work in a commercial
software house. After all, we already have a hard time with branches -
let alone having multiple repositories&#x2026;
</p>

<p>
All this talk about version control reminded me of a set of procedures
for merging and branching I once wrote. I can't take all the credit,
of course, since my good friends Kevin and Chris - the ClearCase
genius - fixed some mistakes and added important bits. Here is the
procedure, in the hope that someone else may find it not entirely
without merit. Apologies for the (lack of) indentation.
</p>

<p>
Merging and Branching
</p>

<ul class="org-ul">
<li>1. Trunk (HEAD/LATEST/[insert version control term here]) is always
compilable and stable.</li>

<li>2. When a new project is started, a set of branches are created:</li>
<li>2.1. Integration branch: off trunk;</li>
<li>2.2. Branch for each developer (or whatever the required granularity
is, one branch per 2 developers, etc.): off the integration branch;</li>
<li>2.3. All branches should be named sensibly and follow a
repository-wide convention (e.g. PRODUCT<sub>TEAM</sub><sub>PROJECT</sub> or something
equally meaningful).</li>

<li>3. Each developer works on his/her own development
branch. Developers must check in every day (PC never contains
unsaved data), but are encouraged to do so more frequently.</li>

<li>4. When the developer is happy enough with his/her changes, he/she
"rebases" (aka forward merges), that is:</li>

<li>4.1. Updates development branch to the current state of the
integration branch (this should be done as often as possible
anyways);</li>
<li>4.2. Ensures no one else is merging to the integration branch;</li>
<li>4.3. Tests development with the new changes (in theory runs his/her
[J|N]Unit tests, in practice, well&#x2026; :-)</li>
<li>4.4. "merges back", that is updates integration branch to the state
of the development branch;</li>
<li>4.5. Features should be merged one-at-a-time, that is if a developer
is working on 5 features for a given release, he/she should merge to
integration each feature at a time, allowing other developers to
pick and test each change rather than one huge patch.</li>

<li>5. While the project is in development, the integration branch may
be rebased from the trunk, but never the opposite (see small
bugfixes below).</li>

<li>6. When the project enters development testing (feature freeze):</li>

<li>6.1. All developers rebase from integration and merge back to
integration as described above;</li>
<li>6.2. Developers test the current state of the integration branch
(normally this means validating the functionality they've
coded). Integration branch is by now equal to dev branches;</li>
<li>6.3. Bugfixes are applied to development branches, and
rebased/merged back to integration (iterate till right).</li>

<li>7. When integration branch is ready for a release to QC (UAT):</li>
<li>7.1. Release branch is created with unique release number, off
integration branch. (i.e. release is "labeled", but this is
equivalent to branching in SVN). All dev branches are locked;</li>
<li>7.2. Release is shipped to QC and release branch is locked;</li>

<li>7.3. If release passes QC, ship it. If release needs another spin:</li>
<li>7.3.1. Bugfix branch is created with the bug ticket number and the
version number. This is off the integration branch;</li>
<li>7.3.2. Bugfix is made, tested in bugfix branch and rebased back to
integration;</li>
<li>7.3.3. When all bugfix branches have been merged in, integration
branch is dev tested;</li>
<li>7.3.4. New release branch with release number is created and
tested. rinse, repeat;</li>
<li>7.3.5. If required, a "special" release branch is created for the
final release so we can distinguish between release candidates and
final release.</li>

<li>8. When a release passes QC and is shipped:</li>
<li>8.1. No one is allowed to merge back to trunk (this has to be
serialized across all teams using the trunk and must be done asap
after the release);</li>
<li>8.2. Integration branch, which at this point is identical to the
final release branch, is rebased off trunk;</li>
<li>8.3. Integration branch is tested (QC should get involved);</li>
<li>8.4. Integration branch is merged back into the trunk;</li>
<li>8.5. At this point the release is complete.</li>

<li>9. Small bugfixes:</li>
<li>9.1. Branch of trunk with version number and bug ticket number (just
integration branch will do, no need for dev branches);</li>
<li>9.2. Do bugfix in integration branch;</li>
<li>9.3. Dev test integration branch;</li>
<li>9.4. Create release branch off integration branch;</li>
<li>9.5. QC release branch;</li>
<li>9.6. Ship;</li>
<li>9.7. Rebase / merge back to trunk.</li>

<li>10. Ideally, once all the merging is done, branches should be
deleted IF the version control system keeps the history of the
merged files. This greatly avoids clutter (i.e. you can actually
find a branch when looking for it), makes the repository smaller and
improves the performance of a few operations.</li>

<li>11. Ideally you should be running something like CruiseControl on
selected branches (such as HEAD and integration).</li>
</ul>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2021-03-28 Sun 15:44</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
